{"version":3,"file":"scanex-loader-widget.js","sources":["../node_modules/@scanex/object-extensions/index.js","../node_modules/@scanex/translations/index.js","../node_modules/@scanex/event-target/index.js","../src/LoaderWidget.js"],"sourcesContent":["const copy = source => {\r\n    switch(typeof source) {\r\n        case 'number':\r\n        case 'string':\r\n        case 'function':\r\n        default:\r\n            return source;\r\n        case 'object':\r\n            if (source === null) {\r\n                return null;\r\n            }\r\n            else if (Array.isArray(source)) {\r\n                return source.map (item => copy (item));\r\n            }\r\n            else if (source instanceof Date) {\r\n                return source;\r\n            }\r\n            else {                \r\n                return Object.keys(source).reduce((a, k) => {                    \r\n                    a[k] = copy(source[k]);\r\n                    return a;\r\n                }, {});\r\n            }\r\n    }\r\n};\r\n\r\nconst extend = (target, source) => {\r\n    if (target === source) {\r\n\t    return target;\r\n    }\r\n    else {\r\n        return Object.keys(source).reduce((a, k) => {\r\n            let value = source[k];\r\n            if(typeof a[k] === 'object' && (k in a)){\r\n                a[k] = extend (a[k], value);\r\n            }\r\n            else {\r\n               a[k] = copy(value);\r\n            }\r\n            return a;\r\n        }, copy (target));\r\n    }    \r\n};\r\n\r\n\r\nexport {copy, extend};","import { extend } from '@scanex/object-extensions';\r\n\r\nconst DEFAULT_LANGUAGE = 'rus';\r\n\r\nclass Translations {\r\n    constructor(){\r\n        this._hash = {};\r\n    }    \r\n    setLanguage (lang) {\r\n        this._language = lang;\r\n    }\r\n    getLanguage () {\r\n        return window.language || this._language || DEFAULT_LANGUAGE;\r\n    }\r\n    addText (lang, tran) {        \r\n        this._hash[lang]= extend(this._hash[lang] || {}, tran);\r\n        return this;\r\n    }\r\n    getText (key) {\r\n        if(key && typeof key === 'string') {\r\n            let locale = this._hash[this.getLanguage()];\r\n            if (locale) {\r\n                return key\r\n                    .split('.')\r\n                    .reduce((a, k) => a[k], locale);\r\n            }         \r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nwindow.Scanex = window.Scanex || {};\r\nwindow.Scanex.Translations = window.Scanex.Translations || {};\r\nwindow.Scanex.translations = window.Scanex.translations || new Translations();\r\n\r\nexport default window.Scanex.translations;","class EventTarget {    \r\n    constructor() {\r\n        this.listeners = {};\r\n    }\r\n    addEventListener(type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            this.listeners[type] = [];\r\n        }\r\n        this.listeners[type].push(callback);\r\n    }\r\n    on(type, callback) {\r\n        this.addEventListener(type, callback);\r\n        return this;\r\n    }\r\n    removeEventListener (type, callback) {\r\n        if(!(type in this.listeners)) {\r\n            return;\r\n        }\r\n        let stack = this.listeners[type];\r\n        for(let i = 0, l = stack.length; i < l; i++) {\r\n            if(stack[i] === callback){\r\n                stack.splice(i, 1);\r\n                return this.removeEventListener(type, callback);\r\n            }\r\n        }\r\n    }\r\n    off(type, callback) {\r\n        this.removeEventListener(type, callback);\r\n        return this;\r\n    }\r\n    dispatchEvent(event) {\r\n        if(!(event.type in this.listeners)) {\r\n            return;\r\n        }\r\n        let stack = this.listeners[event.type];\r\n\t    Object.defineProperty(event, 'target', {\r\n            enumerable: false,\r\n            configurable: false,\r\n            writable: false,\r\n            value: this\r\n        });\r\n        for(let i = 0, l = stack.length; i < l; i++) {\r\n            stack[i].call(this, event);\r\n        }\r\n    }\r\n    \r\n}\r\n\r\nexport default EventTarget;","import './LoaderWidget.css';\r\nimport Translations from '@scanex/translations';\r\nimport EventTarget from '@scanex/event-target';\r\n\r\nlet T = Translations;\r\n\r\nclass LoaderWidget extends EventTarget {\r\n    constructor () {\r\n        super();\r\n        this._container = document.createElement('div');\r\n        document.body.appendChild(this._container);\r\n        this._container.classList.add ('noselect');\r\n        this._container.classList.add('loader-widget');\r\n        this._container.innerHTML = `<div class=\"loader-icon\"></div><div class=\"loader-button\">${T.getText('alerts.cancel')}</div>`;\r\n        this._ovl = document.querySelector('.loader-widget-overlay');\r\n        this._stopPropagation = this._stopPropagation.bind(this);\r\n        if(!this._ovl) {\r\n            this._ovl = document.createElement('div');\r\n            document.body.appendChild(this._ovl);\r\n            this._ovl.className = 'loader-widget-overlay';\r\n            this._ovl.style.display = 'none';\r\n            this._ovl.addEventListener('mousemove', this._stopPropagation);\r\n            this._ovl.addEventListener('mousewheel', this._stopPropagation);\r\n            this._ovl.addEventListener('click', this._stopPropagation);\r\n        }\r\n        this._container.querySelector('.loader-button').addEventListener('click', e => {\r\n            this.hide();            \r\n            let event = document.createEvent('Event');\r\n            event.initEvent('cancel', false, false);\r\n            this.dispatchEvent(event);\r\n        });\r\n        this.show = this.show.bind(this);\r\n        this.hide = this.hide.bind(this);\r\n    }\r\n    _stopPropagation (e) {\r\n        e.stopPropagation();\r\n    }\r\n    show() {        \r\n        this._ovl.style.display = 'block';\r\n        this._container.querySelector('.loader-icon').classList.add('loader-animated');\r\n        this._container.style.visibility = 'visible';        \r\n    }\r\n    hide() {        \r\n        this._ovl.style.display = 'none';\r\n        this._container.querySelector('.loader-icon').classList.remove('loader-animated');\r\n        this._container.style.visibility = 'hidden';        \r\n    }\r\n}\r\n\r\nexport default LoaderWidget;"],"names":["T","Translations","LoaderWidget","_container","document","createElement","body","appendChild","classList","add","innerHTML","getText","_ovl","querySelector","_stopPropagation","bind","className","style","display","addEventListener","e","hide","event","createEvent","initEvent","dispatchEvent","show","stopPropagation","visibility","remove","EventTarget"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,IAAI,GAAG,MAAM,IAAI;AACvB,IAAI,OAAO,OAAO,MAAM;AACxB,QAAQ,KAAK,QAAQ,CAAC;AACtB,QAAQ,KAAK,QAAQ,CAAC;AACtB,QAAQ,KAAK,UAAU,CAAC;AACxB,QAAQ;AACR,YAAY,OAAO,MAAM,CAAC;AAC1B,QAAQ,KAAK,QAAQ;AACrB,YAAY,IAAI,MAAM,KAAK,IAAI,EAAE;AACjC,gBAAgB,OAAO,IAAI,CAAC;AAC5B,aAAa;AACb,iBAAiB,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;AAC5C,gBAAgB,OAAO,MAAM,CAAC,GAAG,EAAE,IAAI,IAAI,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;AACxD,aAAa;AACb,iBAAiB,IAAI,MAAM,YAAY,IAAI,EAAE;AAC7C,gBAAgB,OAAO,MAAM,CAAC;AAC9B,aAAa;AACb,iBAAiB;AACjB,gBAAgB,OAAO,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK;AAC5D,oBAAoB,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;AAC3C,oBAAoB,OAAO,CAAC,CAAC;AAC7B,iBAAiB,EAAE,EAAE,CAAC,CAAC;AACvB,aAAa;AACb,KAAK;AACL,CAAC,CAAC;AACF;AACA,MAAM,MAAM,GAAG,CAAC,MAAM,EAAE,MAAM,KAAK;AACnC,IAAI,IAAI,MAAM,KAAK,MAAM,EAAE;AAC3B,KAAK,OAAO,MAAM,CAAC;AACnB,KAAK;AACL,SAAS;AACT,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK;AACpD,YAAY,IAAI,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AAClC,YAAY,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;AACpD,gBAAgB,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;AAC5C,aAAa;AACb,iBAAiB;AACjB,eAAe,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;AAClC,aAAa;AACb,YAAY,OAAO,CAAC,CAAC;AACrB,SAAS,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC;AAC1B,KAAK;AACL,CAAC;;ACxCD,MAAM,gBAAgB,GAAG,KAAK,CAAC;AAC/B;AACA,MAAM,YAAY,CAAC;AACnB,IAAI,WAAW,EAAE;AACjB,QAAQ,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;AACxB,KAAK;AACL,IAAI,WAAW,CAAC,CAAC,IAAI,EAAE;AACvB,QAAQ,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;AAC9B,KAAK;AACL,IAAI,WAAW,CAAC,GAAG;AACnB,QAAQ,OAAO,MAAM,CAAC,QAAQ,IAAI,IAAI,CAAC,SAAS,IAAI,gBAAgB,CAAC;AACrE,KAAK;AACL,IAAI,OAAO,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE;AACzB,QAAQ,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,CAAC;AAC/D,QAAQ,OAAO,IAAI,CAAC;AACpB,KAAK;AACL,IAAI,OAAO,CAAC,CAAC,GAAG,EAAE;AAClB,QAAQ,GAAG,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;AAC3C,YAAY,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;AACxD,YAAY,IAAI,MAAM,EAAE;AACxB,gBAAgB,OAAO,GAAG;AAC1B,qBAAqB,KAAK,CAAC,GAAG,CAAC;AAC/B,qBAAqB,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;AACpD,aAAa;AACb,SAAS;AACT,QAAQ,OAAO,IAAI,CAAC;AACpB,KAAK;AACL,CAAC;AACD;AACA,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,EAAE,CAAC;AACpC,MAAM,CAAC,MAAM,CAAC,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,IAAI,EAAE,CAAC;AAC9D,MAAM,CAAC,MAAM,CAAC,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,IAAI,IAAI,YAAY,EAAE,CAAC;AAC9E;AACA,qBAAe,MAAM,CAAC,MAAM,CAAC,YAAY;;ACnCzC,MAAM,WAAW,CAAC;AAClB,IAAI,WAAW,GAAG;AAClB,QAAQ,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;AAC5B,KAAK;AACL,IAAI,gBAAgB,CAAC,IAAI,EAAE,QAAQ,EAAE;AACrC,QAAQ,GAAG,EAAE,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE;AACtC,YAAY,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;AACtC,SAAS;AACT,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;AAC5C,KAAK;AACL,IAAI,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE;AACvB,QAAQ,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AAC9C,QAAQ,OAAO,IAAI,CAAC;AACpB,KAAK;AACL,IAAI,mBAAmB,CAAC,CAAC,IAAI,EAAE,QAAQ,EAAE;AACzC,QAAQ,GAAG,EAAE,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE;AACtC,YAAY,OAAO;AACnB,SAAS;AACT,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;AACzC,QAAQ,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACrD,YAAY,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC;AACrC,gBAAgB,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACnC,gBAAgB,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AAChE,aAAa;AACb,SAAS;AACT,KAAK;AACL,IAAI,GAAG,CAAC,IAAI,EAAE,QAAQ,EAAE;AACxB,QAAQ,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AACjD,QAAQ,OAAO,IAAI,CAAC;AACpB,KAAK;AACL,IAAI,aAAa,CAAC,KAAK,EAAE;AACzB,QAAQ,GAAG,EAAE,KAAK,CAAC,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE;AAC5C,YAAY,OAAO;AACnB,SAAS;AACT,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAC/C,KAAK,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,QAAQ,EAAE;AAC5C,YAAY,UAAU,EAAE,KAAK;AAC7B,YAAY,YAAY,EAAE,KAAK;AAC/B,YAAY,QAAQ,EAAE,KAAK;AAC3B,YAAY,KAAK,EAAE,IAAI;AACvB,SAAS,CAAC,CAAC;AACX,QAAQ,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACrD,YAAY,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;AACvC,SAAS;AACT,KAAK;AACL;AACA,CAAC;;AC1CD,IAAIA,CAAC,GAAGC,cAAR;;IAEMC;;;;;AACF,0BAAe;AAAA;;AAAA;;AACX;AACA,UAAKC,UAAL,GAAkBC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAlB;AACAD,IAAAA,QAAQ,CAACE,IAAT,CAAcC,WAAd,CAA0B,MAAKJ,UAA/B;;AACA,UAAKA,UAAL,CAAgBK,SAAhB,CAA0BC,GAA1B,CAA+B,UAA/B;;AACA,UAAKN,UAAL,CAAgBK,SAAhB,CAA0BC,GAA1B,CAA8B,eAA9B;;AACA,UAAKN,UAAL,CAAgBO,SAAhB,2EAAyFV,CAAC,CAACW,OAAF,CAAU,eAAV,CAAzF;AACA,UAAKC,IAAL,GAAYR,QAAQ,CAACS,aAAT,CAAuB,wBAAvB,CAAZ;AACA,UAAKC,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBC,IAAtB,+BAAxB;;AACA,QAAG,CAAC,MAAKH,IAAT,EAAe;AACX,YAAKA,IAAL,GAAYR,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAZ;AACAD,MAAAA,QAAQ,CAACE,IAAT,CAAcC,WAAd,CAA0B,MAAKK,IAA/B;AACA,YAAKA,IAAL,CAAUI,SAAV,GAAsB,uBAAtB;AACA,YAAKJ,IAAL,CAAUK,KAAV,CAAgBC,OAAhB,GAA0B,MAA1B;;AACA,YAAKN,IAAL,CAAUO,gBAAV,CAA2B,WAA3B,EAAwC,MAAKL,gBAA7C;;AACA,YAAKF,IAAL,CAAUO,gBAAV,CAA2B,YAA3B,EAAyC,MAAKL,gBAA9C;;AACA,YAAKF,IAAL,CAAUO,gBAAV,CAA2B,OAA3B,EAAoC,MAAKL,gBAAzC;AACH;;AACD,UAAKX,UAAL,CAAgBU,aAAhB,CAA8B,gBAA9B,EAAgDM,gBAAhD,CAAiE,OAAjE,EAA0E,UAAAC,CAAC,EAAI;AAC3E,YAAKC,IAAL;;AACA,UAAIC,KAAK,GAAGlB,QAAQ,CAACmB,WAAT,CAAqB,OAArB,CAAZ;AACAD,MAAAA,KAAK,CAACE,SAAN,CAAgB,QAAhB,EAA0B,KAA1B,EAAiC,KAAjC;;AACA,YAAKC,aAAL,CAAmBH,KAAnB;AACH,KALD;;AAMA,UAAKI,IAAL,GAAY,MAAKA,IAAL,CAAUX,IAAV,+BAAZ;AACA,UAAKM,IAAL,GAAY,MAAKA,IAAL,CAAUN,IAAV,+BAAZ;AAzBW;AA0Bd;;;;qCACiBK,GAAG;AACjBA,MAAAA,CAAC,CAACO,eAAF;AACH;;;2BACM;AACH,WAAKf,IAAL,CAAUK,KAAV,CAAgBC,OAAhB,GAA0B,OAA1B;;AACA,WAAKf,UAAL,CAAgBU,aAAhB,CAA8B,cAA9B,EAA8CL,SAA9C,CAAwDC,GAAxD,CAA4D,iBAA5D;;AACA,WAAKN,UAAL,CAAgBc,KAAhB,CAAsBW,UAAtB,GAAmC,SAAnC;AACH;;;2BACM;AACH,WAAKhB,IAAL,CAAUK,KAAV,CAAgBC,OAAhB,GAA0B,MAA1B;;AACA,WAAKf,UAAL,CAAgBU,aAAhB,CAA8B,cAA9B,EAA8CL,SAA9C,CAAwDqB,MAAxD,CAA+D,iBAA/D;;AACA,WAAK1B,UAAL,CAAgBc,KAAhB,CAAsBW,UAAtB,GAAmC,QAAnC;AACH;;;;EAxCsBE;;;;"}